"use strict";(self.webpackChunkmango=self.webpackChunkmango||[]).push([[2357],{333:(t,e,i)=>{function n(t){return"string"===typeof t?Number.parseInt(t,"0x"===t.trim().substring(0,2)?16:10):"bigint"===typeof t?Number(t):t}i.d(e,{n:()=>n})},62357:(t,e,i)=>{i.d(e,{PaperWalletConnector:()=>c});var n=i(31932),s=i(27790),o=i(48987),r=i(333),a=i(86995),h=i(46741);i(73026);class c extends h.C{constructor(t){super(),(0,n._)(this,"id",a.w.paper),(0,n._)(this,"name","Paper Wallet"),(0,n._)(this,"ready",!0),(0,n._)(this,"user",null),(0,n._)(this,"onAccountsChanged",(async t=>{0===t.length?await this.onDisconnect():this.emit("change",{account:o.getAddress(t[0])})})),(0,n._)(this,"onChainChanged",(t=>{const e=(0,r.n)(t),i=-1===this.options.chains.findIndex((t=>t.chainId===e));this.emit("change",{chain:{id:e,unsupported:i}})})),(0,n._)(this,"onDisconnect",(async()=>{this.emit("disconnect")})),this.options=t}getPaperSDK(){return this.paper||(this.paper=new Promise((async(t,e)=>{const n=this.options.advancedOptions?.recoveryShareManagement;try{const{PaperEmbeddedWalletSdk:e}=await Promise.resolve().then(i.bind(i,27790)),o={AWS_MANAGED:s.Q.AWS_MANAGED,USER_MANAGED:s.Q.USER_MANAGED};t(new e({advancedOptions:{recoveryShareManagement:n?o[n]:void 0},clientId:this.options.clientId,chain:"Ethereum",styles:this.options.styles,onAuthSuccess:this.options.onAuthSuccess}))}catch(o){e(o)}}))),this.paper}async connect(t){const e=await this.getPaperSDK();if(!e)throw new Error("Paper SDK not initialized");const i=await e.getUser();switch(i.status){case s._O.LOGGED_OUT:{let i;if(t?.googleLogin){const n=t.googleLogin;i=await e.auth.loginWithGoogle("object"===typeof n?n:void 0)}else i=t?.email&&t?.otp?await e.auth.verifyPaperEmailLoginOtp({email:t.email,otp:t.otp,recoveryCode:t.recoveryCode}):t?.email?await e.auth.loginWithPaperEmailOtp({email:t.email}):await e.auth.loginWithPaperModal();this.user=i.user;break}case s._O.LOGGED_IN_WALLET_INITIALIZED:"object"===typeof t?.googleLogin&&t.googleLogin.closeOpenedWindow&&t.googleLogin.openedWindow&&t.googleLogin.closeOpenedWindow(t.googleLogin.openedWindow),this.user=i}if(!this.user)throw new Error("Error connecting User");return t?.chainId&&this.switchChain(t.chainId),this.setupListeners(),this.getAddress()}async disconnect(){const t=await this.paper;await(t?.auth.logout()),this._signer=void 0,this.user=null}async getAddress(){return(await this.getSigner()).getAddress()}async isConnected(){try{return!!await this.getAddress()}catch(t){return!1}}async getProvider(){const t=await this.getSigner();if(!t.provider)throw new Error("Provider not found");return t.provider}async getSigner(){if(this._signer)return this._signer;if(!this.user){const t=await this.getPaperSDK(),e=await t.getUser();if(e.status===s._O.LOGGED_IN_WALLET_INITIALIZED)this.user=e}const t=await(this.user?.wallet.getEthersJsSigner({rpcEndpoint:this.options.chain.rpc[0]||""}));if(!t)throw new Error("Signer not found");return this._signer=t,t}async isAuthorized(){return!1}async switchChain(t){const e=this.options.chains.find((e=>e.chainId===t));if(!e)throw new Error("Chain not configured");await(this.user?.wallet.setChain({chain:"Ethereum"})),this._signer=await(this.user?.wallet.getEthersJsSigner({rpcEndpoint:e.rpc[0]||""})),this.emit("change",{chain:{id:t,unsupported:!1}})}async setupListeners(){const t=await this.getProvider();t.on&&(t.on("accountsChanged",this.onAccountsChanged),t.on("chainChanged",this.onChainChanged),t.on("disconnect",this.onDisconnect))}updateChains(t){this.options.chains=t}async getEmail(){if(await this.getProvider(),!this.user)throw new Error("No user found, Paper Wallet is not connected");return this.user.authDetails.email}}}}]);
//# sourceMappingURL=2357.a5e24f71.chunk.js.map