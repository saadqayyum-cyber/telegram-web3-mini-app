{"version":3,"file":"static/js/6492.c72d8eb4.chunk.js","mappings":"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","sources":["../node_modules/@thirdweb-dev/wallets/evm/connectors/embedded-wallet/dist/thirdweb-dev-wallets-evm-connectors-embedded-wallet.browser.esm.js","../node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-1fb9aedf.browser.esm.js"],"sourcesContent":["import { _ as _defineProperty } from '../../../../dist/defineProperty-350fc508.browser.esm.js';\nimport { utils } from 'ethers';\nimport { n as normalizeChainId } from '../../../../dist/normalizeChainId-1fb9aedf.browser.esm.js';\nimport { w as walletIds } from '../../../../dist/walletIds-dff6dced.browser.esm.js';\nimport { C as Connector } from '../../../../dist/connector-05689d68.browser.esm.js';\nimport { E as EmbeddedWalletSdk, U as UserWalletStatus, c as AuthProvider } from '../../../../dist/embedded-wallet-e375380a.browser.esm.js';\nimport 'eventemitter3';\nimport '@paperxyz/sdk-common-utilities';\nimport 'ethers/lib/utils';\nimport '@thirdweb-dev/sdk';\n\nclass EmbeddedWalletConnector extends Connector {\n  constructor(options) {\n    super();\n    _defineProperty(this, \"id\", walletIds.paper);\n    _defineProperty(this, \"name\", \"Embedded Wallet\");\n    _defineProperty(this, \"ready\", true);\n    _defineProperty(this, \"user\", null);\n    _defineProperty(this, \"onAccountsChanged\", async accounts => {\n      if (accounts.length === 0) {\n        await this.onDisconnect();\n      } else {\n        this.emit(\"change\", {\n          account: utils.getAddress(accounts[0])\n        });\n      }\n    });\n    _defineProperty(this, \"onChainChanged\", chainId => {\n      const id = normalizeChainId(chainId);\n      const unsupported = this.options.chains.findIndex(c => c.chainId === id) === -1;\n      this.emit(\"change\", {\n        chain: {\n          id,\n          unsupported\n        }\n      });\n    });\n    _defineProperty(this, \"onDisconnect\", async () => {\n      this.emit(\"disconnect\");\n    });\n    this.options = options;\n  }\n  getEmbeddedWalletSDK() {\n    if (!this._embeddedWalletSdk) {\n      this._embeddedWalletSdk = new EmbeddedWalletSdk({\n        clientId: this.options.clientId,\n        chain: \"Ethereum\",\n        onAuthSuccess: this.options.onAuthSuccess\n      });\n    }\n    return this._embeddedWalletSdk;\n  }\n  async connect(args) {\n    // backwards compatibility - options should really be required here\n    if (!args) {\n      // default to iframe flow\n      const result = await this.authenticate({\n        strategy: \"iframe\"\n      });\n      if (!result.user) {\n        throw new Error(\"Error connecting User\");\n      }\n      this.user = result.user;\n    } else {\n      if (!args.authResult) {\n        throw new Error(\"Missing authData - call authenticate() first with your authentication strategy\");\n      }\n      if (!args.authResult.user) {\n        throw new Error(\"Missing authData.user - call authenticate() first with your authentication strategy\");\n      }\n      this.user = args.authResult.user;\n    }\n    if (args?.chainId) {\n      this.switchChain(args.chainId);\n    }\n    return this.getAddress();\n  }\n  async disconnect() {\n    const paper = this._embeddedWalletSdk;\n    await paper?.auth.logout();\n    this._signer = undefined;\n    this._embeddedWalletSdk = undefined;\n    this.user = null;\n  }\n  async getAddress() {\n    if (!this.user) {\n      throw new Error(\"Embedded Wallet is not connected\");\n    }\n    return await this.getSigner().then(signer => signer.getAddress());\n  }\n  async isConnected() {\n    try {\n      const addr = await this.getAddress();\n      return !!addr;\n    } catch (e) {\n      return false;\n    }\n  }\n  async getProvider() {\n    const signer = await this.getSigner();\n    if (!signer.provider) {\n      throw new Error(\"Provider not found\");\n    }\n    return signer.provider;\n  }\n  async getSigner() {\n    if (this._signer) {\n      return this._signer;\n    }\n    const user = await this.getUser();\n    const signer = await user.wallet.getEthersJsSigner({\n      rpcEndpoint: this.options.chain.rpc[0] || \"\" // TODO: handle chain.rpc being empty array\n    });\n    if (!signer) {\n      throw new Error(\"Signer not found\");\n    }\n    this._signer = signer;\n    return signer;\n  }\n  async isAuthorized() {\n    return false;\n  }\n  async switchChain(chainId) {\n    const chain = this.options.chains.find(c => c.chainId === chainId);\n    if (!chain) {\n      throw new Error(\"Chain not configured\");\n    }\n    try {\n      // update chain in wallet\n      await this.user?.wallet.setChain({\n        chain: \"Ethereum\"\n      }); // just pass Ethereum no matter what chain we are going to connect\n      // update signer\n      this._signer = await this.user?.wallet.getEthersJsSigner({\n        rpcEndpoint: chain.rpc[0] || \"\"\n      });\n      this.emit(\"change\", {\n        chain: {\n          id: chainId,\n          unsupported: false\n        }\n      });\n    } catch (e) {\n      console.warn(\"Failed to switch chain\", e);\n    }\n  }\n  async setupListeners() {\n    return Promise.resolve();\n  }\n  updateChains(chains) {\n    this.options.chains = chains;\n  }\n  async getUser() {\n    if (!this.user || !this.user.wallet || !this.user.wallet.getEthersJsSigner // when serializing, functions are lost, need to rehydrate\n    ) {\n      const embeddedWalletSdk = this.getEmbeddedWalletSDK();\n      const user = await embeddedWalletSdk.getUser();\n      switch (user.status) {\n        case UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED:\n          {\n            this.user = user;\n            break;\n          }\n        default:\n          {\n            // if logged out or unitialized, we can't get a signer, so throw an error\n            throw new Error(\"Embedded Wallet is not authenticated, please authenticate first\");\n          }\n      }\n    }\n    return this.user;\n  }\n  async getEmail() {\n    const user = await this.getUser();\n    return user.authDetails.email;\n  }\n  async getPhoneNumber() {\n    const user = await this.getUser();\n    return user.authDetails.phoneNumber;\n  }\n  async getRecoveryInformation() {\n    const user = await this.getUser();\n    return user.authDetails;\n  }\n  async sendVerificationEmail(_ref) {\n    let {\n      email\n    } = _ref;\n    const ewSDK = this.getEmbeddedWalletSDK();\n    return ewSDK.auth.sendEmailLoginOtp({\n      email\n    });\n  }\n  async sendVerificationSms(_ref2) {\n    let {\n      phoneNumber\n    } = _ref2;\n    const ewSDK = this.getEmbeddedWalletSDK();\n    return ewSDK.auth.sendSmsLoginOtp({\n      phoneNumber\n    });\n  }\n  async authenticate(params) {\n    const ewSDK = this.getEmbeddedWalletSDK();\n    const strategy = params.strategy;\n    switch (strategy) {\n      case \"email_verification\":\n        {\n          return await ewSDK.auth.verifyEmailLoginOtp({\n            email: params.email,\n            otp: params.verificationCode,\n            recoveryCode: params.recoveryCode\n          });\n        }\n      case \"phone_number_verification\":\n        {\n          return await ewSDK.auth.verifySmsLoginOtp({\n            phoneNumber: params.phoneNumber,\n            otp: params.verificationCode,\n            recoveryCode: params.recoveryCode\n          });\n        }\n      case \"apple\":\n      case \"facebook\":\n      case \"google\":\n        {\n          const oauthProvider = oauthStrategyToAuthProvider[strategy];\n          return ewSDK.auth.loginWithOauth({\n            oauthProvider,\n            closeOpenedWindow: params.closeOpenedWindow,\n            openedWindow: params.openedWindow\n          });\n        }\n      case \"jwt\":\n        {\n          return ewSDK.auth.loginWithCustomJwt({\n            jwt: params.jwt,\n            encryptionKey: params.encryptionKey\n          });\n        }\n      case \"auth_endpoint\":\n        {\n          return ewSDK.auth.loginWithCustomAuthEndpoint({\n            payload: params.payload,\n            encryptionKey: params.encryptionKey\n          });\n        }\n      case \"iframe_email_verification\":\n        {\n          return ewSDK.auth.loginWithEmailOtp({\n            email: params.email\n          });\n        }\n      case \"iframe\":\n        {\n          return ewSDK.auth.loginWithModal();\n        }\n      default:\n        assertUnreachable(strategy);\n    }\n  }\n}\nfunction assertUnreachable(x) {\n  throw new Error(\"Invalid param: \" + x);\n}\nconst oauthStrategyToAuthProvider = {\n  google: AuthProvider.GOOGLE,\n  facebook: AuthProvider.FACEBOOK,\n  apple: AuthProvider.APPLE\n};\n\nexport { EmbeddedWalletConnector };\n","/**\n * @internal\n */\nfunction normalizeChainId(chainId) {\n  if (typeof chainId === \"string\") {\n    return Number.parseInt(chainId, chainId.trim().substring(0, 2) === \"0x\" ? 16 : 10);\n  }\n  if (typeof chainId === \"bigint\") {\n    return Number(chainId);\n  }\n  return chainId;\n}\n\nexport { normalizeChainId as n };\n"],"names":["EmbeddedWalletConnector","Connector","constructor","options","super","_defineProperty","this","walletIds","paper","async","accounts","length","onDisconnect","emit","account","utils","chainId","id","normalizeChainId","unsupported","chains","findIndex","c","chain","getEmbeddedWalletSDK","_embeddedWalletSdk","EmbeddedWalletSdk","clientId","onAuthSuccess","connect","args","authResult","Error","user","result","authenticate","strategy","switchChain","getAddress","disconnect","auth","logout","_signer","undefined","getSigner","then","signer","isConnected","e","getProvider","provider","getUser","wallet","getEthersJsSigner","rpcEndpoint","rpc","isAuthorized","find","setChain","console","warn","setupListeners","Promise","resolve","updateChains","embeddedWalletSdk","status","UserWalletStatus","LOGGED_IN_WALLET_INITIALIZED","getEmail","authDetails","email","getPhoneNumber","phoneNumber","getRecoveryInformation","sendVerificationEmail","_ref","sendEmailLoginOtp","sendVerificationSms","_ref2","sendSmsLoginOtp","params","ewSDK","verifyEmailLoginOtp","otp","verificationCode","recoveryCode","verifySmsLoginOtp","oauthProvider","oauthStrategyToAuthProvider","loginWithOauth","closeOpenedWindow","openedWindow","loginWithCustomJwt","jwt","encryptionKey","loginWithCustomAuthEndpoint","payload","loginWithEmailOtp","loginWithModal","x","assertUnreachable","google","AuthProvider","GOOGLE","facebook","FACEBOOK","apple","APPLE","Number","parseInt","trim","substring"],"sourceRoot":""}